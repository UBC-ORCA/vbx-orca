#include "neural.h"

#if CATEGORIES == 2 //n230

layer_t cifar_reduced[] = {
	{.conv={CONV, RELU, 0, 32, 32, 3, 16, 0, REDUCED_FLASH_DATA_OFFSET+0, 1, 1}},
	{.conv={CONV, RELU, 0, 32, 32, 16, 16, 1, REDUCED_FLASH_DATA_OFFSET+224, 1, 1}},
	{.conv={CONV, RELU, 0, 16, 16, 16, 32, 0, REDUCED_FLASH_DATA_OFFSET+864, 1, 1}},
	{.conv={CONV, RELU, 0, 16, 16, 32, 32, 1, REDUCED_FLASH_DATA_OFFSET+2144, 1, 1}},
	{.conv={CONV, RELU, 0, 8, 8, 32, 48, 0, REDUCED_FLASH_DATA_OFFSET+4448, 1, 1}},
	{.conv={CONV, RELU, 0, 8, 8, 48, 48, 1, REDUCED_FLASH_DATA_OFFSET+7904, 1, 0}},
	{.dense={DENSE, RELU, 0, 768, 64, REDUCED_FLASH_DATA_OFFSET+12896, REDUCED_FLASH_DATA_OFFSET+19040, 1, REDUCED_FLASH_DATA_OFFSET+19296}},
	{.dense={DENSE, RELU, 0, 64, 64, REDUCED_FLASH_DATA_OFFSET+19552, REDUCED_FLASH_DATA_OFFSET+20064, 1, REDUCED_FLASH_DATA_OFFSET+20320}},
	{.dense={DENSE, LINEAR, 1, 64, 2, REDUCED_FLASH_DATA_OFFSET+20576, REDUCED_FLASH_DATA_OFFSET+20592, 1, REDUCED_FLASH_DATA_OFFSET+20600}},
		};
const char *categories[] = {"face","noface"};
#elif CATEGORIES == 10
layer_t cifar_reduced[] = {
        {.conv={CONV, RELU, 0, 32, 32, 3, 16, 0, REDUCED_FLASH_DATA_OFFSET+0, 1, 1}},
        {.conv={CONV, RELU, 0, 32, 32, 16, 32, 1, REDUCED_FLASH_DATA_OFFSET+224, 1, 1}},
        {.conv={CONV, RELU, 0, 16, 16, 32, 32, 0, REDUCED_FLASH_DATA_OFFSET+1504, 1, 1}},
        {.conv={CONV, RELU, 0, 16, 16, 32, 64, 1, REDUCED_FLASH_DATA_OFFSET+3808, 1, 1}},
        {.conv={CONV, RELU, 0, 8, 8, 64, 64, 0, REDUCED_FLASH_DATA_OFFSET+8416, 1, 1}},
        {.conv={CONV, RELU, 0, 8, 8, 64, 96, 1, REDUCED_FLASH_DATA_OFFSET+17120, 1, 0}},
        {.dense={DENSE, RELU, 0, 1536, 64, REDUCED_FLASH_DATA_OFFSET+30176, REDUCED_FLASH_DATA_OFFSET+42464, 1, REDUCED_FLASH_DATA_OFFSET+42720}},
        {.dense={DENSE, RELU, 0, 64, 64, REDUCED_FLASH_DATA_OFFSET+42976, REDUCED_FLASH_DATA_OFFSET+43488, 1, REDUCED_FLASH_DATA_OFFSET+43744}},
        {.dense={DENSE, LINEAR, 1, 64, 10, REDUCED_FLASH_DATA_OFFSET+44000, REDUCED_FLASH_DATA_OFFSET+44080, 1, REDUCED_FLASH_DATA_OFFSET+44120}},
};
const	char *categories[] = {"air", "auto", "bird", "cat", "person", "dog", "frog", "horse", "ship", "truck"};
#endif
